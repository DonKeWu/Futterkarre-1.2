#!/bin/bash
# üî• ESP8266 WiFi-Verbindungsprobleme ENDG√úLTIG l√∂sen!

echo "üö® ESP8266 WiFi-Debugging - T√§glich gr√º√üt das Murmeltier!"
echo "========================================================="

echo ""
echo "üîç SCHRITT 1: WiFi-Netzwerk pr√ºfen"
echo "-----------------------------------"
echo "1. Router-Name/SSID pr√ºfen:"
iwconfig 2>/dev/null || echo "iwconfig nicht verf√ºgbar"
nmcli dev wifi list 2>/dev/null || echo "nmcli nicht verf√ºgbar"

echo ""
echo "2. Aktuelle WiFi-Verbindung:"
ip route | grep default

echo ""
echo "üîß SCHRITT 2: H√§ufigste ESP8266 WiFi-Probleme"
echo "--------------------------------------------"
echo "‚ùå PROBLEM 1: Falsche SSID/Passwort im Code"
echo "   ‚Üí ESP8266-Code pr√ºfen: WiFi.begin(ssid, password)"
echo ""
echo "‚ùå PROBLEM 2: 5GHz WiFi (ESP8266 kann nur 2.4GHz!)"
echo "   ‚Üí Router auf 2.4GHz-Band pr√ºfen"
echo ""
echo "‚ùå PROBLEM 3: Versteckte SSID" 
echo "   ‚Üí Router SSID-Broadcast aktivieren"
echo ""
echo "‚ùå PROBLEM 4: WPA3-Verschl√ºsselung (ESP8266 = WPA/WPA2 only!)"
echo "   ‚Üí Router auf WPA2 umstellen"
echo ""
echo "‚ùå PROBLEM 5: MAC-Filter aktiv"
echo "   ‚Üí ESP8266 MAC-Adresse im Router freischalten"
echo ""
echo "‚ùå PROBLEM 6: Zu schwaches WiFi-Signal"
echo "   ‚Üí ESP8266 n√§her zum Router"

echo ""
echo "üõ†Ô∏è  SCHRITT 3: ESP8266 Serial Monitor Debugging"
echo "-----------------------------------------------"
echo "1. Arduino IDE ‚Üí Serial Monitor (115200 baud)"
echo "2. ESP8266 Reset/Neustart"
echo "3. WiFi-Debug-Meldungen lesen:"
echo ""
echo "   ‚úÖ ERFOLG-Meldungen:"
echo "      'WiFi connected'"
echo "      'IP address: 192.168.2.20'"
echo "      'Static IP configured'"
echo ""
echo "   ‚ùå FEHLER-Meldungen:"
echo "      'WiFi connection failed'"
echo "      'No networks found'"
echo "      'Wrong password'"
echo "      'Timeout connecting'"

echo ""
echo "‚ö° SCHRITT 4: SOFORT-FIX Versuche"
echo "--------------------------------"
echo "1. Router neustarten (Strom weg 30s)"
echo "2. ESP8266 neustarten (Reset-Button)" 
echo "3. Anderen 2.4GHz-Kanal (1, 6, 11) am Router"
echo "4. Router WiFi-Modus auf 'gemischt 2.4GHz + 5GHz'"
echo "5. Tempor√§r Router-Gastnetzwerk aktivieren"

echo ""
echo "üî• SCHRITT 5: NOTFALL-L√ñSUNG - Access Point Modus"
echo "------------------------------------------------"
echo "Falls WiFi-Station nicht geht:"
echo "1. ESP8266 Web-UI: http://192.168.4.1/"
echo "2. Access Point 'ESP8266-HX711' suchen"
echo "3. Mit Handy/Laptop verbinden"
echo "4. WiFi-Konfiguration √ºber Web-Interface"

echo ""
echo "üìã DEBUGGING-CHECKLISTE:"
echo "========================"
echo "‚ñ° Serial Monitor Ausgabe gelesen?"
echo "‚ñ° Router 2.4GHz aktiv?" 
echo "‚ñ° WPA2-Verschl√ºsselung (nicht WPA3)?"
echo "‚ñ° SSID sichtbar (nicht versteckt)?"
echo "‚ñ° ESP8266 in Router-N√§he?"
echo "‚ñ° Richtiges WiFi-Passwort im Code?"
echo "‚ñ° Router neugestartet?"
echo "‚ñ° ESP8266 neugestartet?"

echo ""
echo "üí° TIPP: Handy-Hotspot als Test"
echo "==============================="
echo "Schnelltest mit Handy-Hotspot:"
echo "1. Handy-Hotspot: Name='TEST', Passwort='12345678'"
echo "2. ESP8266-Code anpassen: WiFi.begin('TEST', '12345678')"  
echo "3. Flashen und testen"
echo "4. Wenn das geht ‚Üí Router-Problem!"
echo ""
echo "üéØ Ziel: ESP8266 soll zeigen: 'Static IP: 192.168.2.20'"